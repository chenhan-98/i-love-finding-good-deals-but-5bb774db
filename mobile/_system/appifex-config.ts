/**
 * Appifex Configuration for Generated Apps
 *
 * AUTO-GENERATED FILE - DO NOT EDIT MANUALLY
 * This file is automatically generated during code generation and contains
 * project/session metadata required for error tracking and debugging.
 *
 * Why hardcoded values:
 * Environment variables (EXPO_PUBLIC_*) are processed at build time by Metro,
 * but may not be available at runtime in all scenarios. This config file uses
 * template placeholders that are replaced during deployment with actual values
 * to ensure they're always accessible for error tracking.
 */

interface AppifexConfig {
  readonly projectId: string;
  readonly sessionId: string;
  readonly sentryDsn: string;
  readonly backendUrl: string;
}

/**
 * Creates and validates Appifex configuration.
 * Template placeholders ({{PLACEHOLDER}}) are replaced during deployment.
 */
function createAppifexConfig(): AppifexConfig {
  const config = {
    /** Links this app to an Appifex project */
    projectId: '5bb774db-183c-4bef-99cd-d03cc97e7518',
    /** Links this deployment to a development session */
    sessionId: '599c38f9-58a0-4f5c-b48d-82a8910b82a2',
    /** Sentry DSN for centralized error monitoring */
    sentryDsn: '',
    /** Appifex backend URL for telemetry */
    backendUrl: 'https://discoverable-uncurdling-lourdes.ngrok-free.dev',
  };

  // Validation: warn if template placeholders weren't replaced
  // This helps catch deployment configuration issues
  if (config.projectId.indexOf('{{') !== -1 || config.sessionId.indexOf('{{') !== -1) {
    console.warn(
      '⚠️ Appifex metadata contains template placeholders - deployment may be misconfigured.\n' +
      'Error tracking may not work correctly. Check deployment logs for env injection errors.'
    );
  }

  // Validation: warn if values are empty (shouldn't happen with proper deployment)
  if (!config.projectId || !config.sessionId) {
    console.warn(
      '⚠️ Appifex metadata is empty - error tracking may not work.\n' +
      'Errors will still be captured by Sentry but may not appear in the Appifex dashboard.'
    );
  }

  // Debug: Log config values on startup (masked for security)
  console.log('[Appifex Config] Loaded:', {
    projectId: config.projectId.length > 8 ? config.projectId.substring(0, 8) + '...' : config.projectId,
    sessionId: config.sessionId.length > 8 ? config.sessionId.substring(0, 8) + '...' : config.sessionId,
    hasDsn: !!config.sentryDsn && config.sentryDsn.length > 10,
    isTemplate: config.projectId.includes('{{'),
  });

  return config;
}

export const APPIFEX_CONFIG = createAppifexConfig();
